# PUT
### wrk2
Обстрел производился одним потоком с 64 соединениями. Заданную нагрузку сервер отрабатывает успешно - 996.65 запросов в секунду. Среднеквадратичное отклонение составляет 98.17%. За 5 минут было обработано успешно почти 300 тысяч запросов. 

    Running 5m test @ http://localhost:8080
    1 threads and 64 connections
    Thread calibration: mean lat.: 4.998ms, rate sampling interval: 16ms
    Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     3.35ms    6.77ms 195.33ms   98.17%
    Req/Sec     1.08k     1.59k   11.12k    76.16%
    Latency Distribution (HdrHistogram - Recorded Latency)
    50.000%    2.57ms
    75.000%    3.40ms
    90.000%    4.53ms
    99.000%   17.65ms
    99.900%  117.50ms
    99.990%  189.05ms
    99.999%  193.92ms
    100.000%  195.46ms

    Detailed Percentile spectrum:
    Value   Percentile   TotalCount 1/(1-Percentile)

       0.127     0.000000            1         1.00
       1.302     0.100000        29005         1.11
       1.705     0.200000        57941         1.25
       2.016     0.300000        86968         1.43
       2.297     0.400000       115948         1.67
       2.571     0.500000       145036         2.00
       2.709     0.550000       159364         2.22
       2.857     0.600000       173960         2.50
       3.011     0.650000       188345         2.86
       3.191     0.700000       202896         3.33
       3.399     0.750000       217249         4.00
       3.521     0.775000       224504         4.44
       3.661     0.800000       231753         5.00
       3.825     0.825000       239012         5.71
       4.013     0.850000       246232         6.67
       4.247     0.875000       253554         8.00
       4.383     0.887500       257117         8.89
       4.535     0.900000       260712        10.00
       4.719     0.912500       264325        11.43
       4.943     0.925000       267953        13.33
       5.231     0.937500       271597        16.00
       5.403     0.943750       273375        17.78
       5.623     0.950000       275182        20.00
       5.903     0.956250       276998        22.86
       6.303     0.962500       278803        26.67
       6.983     0.968750       280614        32.00
       7.455     0.971875       281528        35.56
       8.083     0.975000       282424        40.00
       8.887     0.978125       283331        45.71
       9.911     0.981250       284234        53.33
      11.959     0.984375       285138        64.00
      13.439     0.985938       285591        71.11
      14.727     0.987500       286047        80.00
      16.303     0.989062       286496        91.43
      18.831     0.990625       286949       106.67
      23.871     0.992188       287402       128.00
      27.439     0.992969       287628       142.22
      33.343     0.993750       287855       160.00
      38.239     0.994531       288080       182.86
      41.439     0.995313       288307       213.33
      46.751     0.996094       288533       256.00
      49.599     0.996484       288647       284.44
      63.263     0.996875       288759       320.00
      72.767     0.997266       288873       365.71
      77.951     0.997656       288986       426.67
      81.791     0.998047       289099       512.00
      87.039     0.998242       289156       568.89
      93.183     0.998437       289213       640.00
      95.807     0.998633       289268       731.43
     112.127     0.998828       289325       853.33
     122.431     0.999023       289382      1024.00
     124.415     0.999121       289411      1137.78
     129.471     0.999219       289438      1280.00
     133.759     0.999316       289466      1462.86
     140.671     0.999414       289496      1706.67
     147.327     0.999512       289523      2048.00
     148.991     0.999561       289539      2275.56
     150.783     0.999609       289551      2560.00
     153.983     0.999658       289565      2925.71
     162.943     0.999707       289580      3413.33
     170.239     0.999756       289594      4096.00
     173.567     0.999780       289601      4551.11
     174.719     0.999805       289608      5120.00
     177.023     0.999829       289615      5851.43
     187.519     0.999854       289622      6826.67
     188.415     0.999878       289629      8192.00
     189.055     0.999890       289636      9102.22
     189.055     0.999902       289636     10240.00
     189.567     0.999915       289640     11702.86
     189.951     0.999927       289643     13653.33
     190.335     0.999939       289647     16384.00
     190.591     0.999945       289649     18204.44
     190.719     0.999951       289650     20480.00
     190.975     0.999957       289652     23405.71
     191.103     0.999963       289654     27306.67
     191.231     0.999969       289656     32768.00
     191.359     0.999973       289657     36408.89
     191.359     0.999976       289657     40960.00
     192.511     0.999979       289658     46811.43
     192.767     0.999982       289659     54613.33
     192.895     0.999985       289660     65536.00
     193.919     0.999986       289661     72817.78
     193.919     0.999988       289661     81920.00
     193.919     0.999989       289661     93622.86
     194.047     0.999991       289662    109226.67
     194.047     0.999992       289662    131072.00
     194.943     0.999993       289663    145635.56
     194.943     0.999994       289663    163840.00
     194.943     0.999995       289663    187245.71
     194.943     0.999995       289663    218453.33
     194.943     0.999996       289663    262144.00
     195.455     0.999997       289664    291271.11
     195.455     1.000000       289664          inf
    #[Mean    =        3.347, StdDeviation   =        6.773]
    #[Max     =      195.328, Total count    =       289664]
    #[Buckets =           27, SubBuckets     =         2048]
    ----------------------------------------------------------
    299013 requests in 5.00m, 23.66MB read
    Requests/sec:    996.65
    Transfer/sec:     80.76KB

### Profiler

20.9% тратится на обращение к другой ноде, 20.25% уходит на работу с очередью обработки запросов.
37.13% занимает работа селекторов, на работу с сессией уходит 8.19%.

[cpu flameGraph](get_cpu.html)

36.75% памяти тратится на проксирование запроса, ответ занимает 22.10%.
Поиск ноды занимает почти 8% 

[alloc flameGraph](put_alloc.html)


[lock_flameGraph](put_lock.html)


# GET

### wrk2

Обстрел производился одним потоком с 64 соединениями.  

    Running 5m test @ http://localhost:8080
    1 threads and 64 connections
    Thread calibration: mean lat.: 4.824ms, rate sampling interval: 15ms
    Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     3.19ms    2.84ms 111.04ms   92.72%
    Req/Sec     1.08k     1.66k    4.57k    77.46%
    Latency Distribution (HdrHistogram - Recorded Latency)
    50.000%    2.60ms
    75.000%    3.76ms
    90.000%    5.38ms
    99.000%   12.01ms
    99.900%   38.17ms
    99.990%   58.81ms
    99.999%   99.46ms
    100.000%  111.10ms

    Detailed Percentile spectrum:
    Value   Percentile   TotalCount 1/(1-Percentile)

       0.194     0.000000            1         1.00
       1.300     0.100000        28992         1.11
       1.657     0.200000        57963         1.25
       1.981     0.300000        86972         1.43
       2.281     0.400000       115885         1.67
       2.595     0.500000       144839         2.00
       2.775     0.550000       159333         2.22
       2.977     0.600000       173880         2.50
       3.195     0.650000       188374         2.86
       3.447     0.700000       202837         3.33
       3.761     0.750000       217318         4.00
       3.943     0.775000       224497         4.44
       4.151     0.800000       231789         5.00
       4.383     0.825000       239042         5.71
       4.651     0.850000       246271         6.67
       4.971     0.875000       253462         8.00
       5.167     0.887500       257135         8.89
       5.383     0.900000       260722        10.00
       5.643     0.912500       264336        11.43
       5.967     0.925000       267942        13.33
       6.347     0.937500       271573        16.00
       6.571     0.943750       273374        17.78
       6.831     0.950000       275191        20.00
       7.123     0.956250       277001        22.86
       7.471     0.962500       278807        26.67
       7.915     0.968750       280630        32.00
       8.179     0.971875       281518        35.56
       8.479     0.975000       282431        40.00
       8.871     0.978125       283331        45.71
       9.367     0.981250       284235        53.33
      10.023     0.984375       285145        64.00
      10.455     0.985938       285595        71.11
      10.975     0.987500       286046        80.00
      11.575     0.989062       286497        91.43
      12.327     0.990625       286949       106.67
      13.487     0.992188       287401       128.00
      14.407     0.992969       287628       142.22
      15.551     0.993750       287855       160.00
      17.231     0.994531       288080       182.86
      18.895     0.995313       288310       213.33
      20.975     0.996094       288534       256.00
      22.207     0.996484       288647       284.44
      23.999     0.996875       288760       320.00
      25.775     0.997266       288872       365.71
      27.807     0.997656       288986       426.67
      30.095     0.998047       289099       512.00
      31.247     0.998242       289156       568.89
      32.111     0.998437       289212       640.00
      33.983     0.998633       289270       731.43
      36.287     0.998828       289325       853.33
      38.463     0.999023       289382      1024.00
      39.199     0.999121       289410      1137.78
      39.775     0.999219       289439      1280.00
      40.639     0.999316       289467      1462.86
      42.079     0.999414       289495      1706.67
      45.375     0.999512       289523      2048.00
      47.903     0.999561       289537      2275.56
      48.671     0.999609       289551      2560.00
      49.791     0.999658       289565      2925.71
      50.783     0.999707       289580      3413.33
      52.063     0.999756       289594      4096.00
      52.479     0.999780       289601      4551.11
      52.863     0.999805       289608      5120.00
      54.271     0.999829       289615      5851.43
      56.415     0.999854       289622      6826.67
      57.471     0.999878       289629      8192.00
      58.687     0.999890       289634      9102.22
      59.807     0.999902       289636     10240.00
      70.719     0.999915       289640     11702.86
      74.879     0.999927       289643     13653.33
      95.039     0.999939       289647     16384.00
      95.487     0.999945       289649     18204.44
      95.615     0.999951       289650     20480.00
      96.191     0.999957       289652     23405.71
      96.767     0.999963       289654     27306.67
      97.343     0.999969       289656     32768.00
      98.047     0.999973       289657     36408.89
      98.047     0.999976       289657     40960.00
      98.111     0.999979       289658     46811.43
      99.327     0.999982       289659     54613.33
      99.391     0.999985       289660     65536.00
      99.455     0.999986       289661     72817.78
      99.455     0.999988       289661     81920.00
      99.455     0.999989       289661     93622.86
     108.415     0.999991       289662    109226.67
     108.415     0.999992       289662    131072.00
     110.271     0.999993       289663    145635.56
     110.271     0.999994       289663    163840.00
     110.271     0.999995       289663    187245.71
     110.271     0.999995       289663    218453.33
     110.271     0.999996       289663    262144.00
     111.103     0.999997       289664    291271.11
     111.103     1.000000       289664          inf
    #[Mean    =        3.193, StdDeviation   =        2.844]
    #[Max     =      111.040, Total count    =       289664]
    #[Buckets =           27, SubBuckets     =         2048]
    ----------------------------------------------------------
    299012 requests in 5.00m, 25.54MB read
    Requests/sec:    996.65
    Transfer/sec:     87.18KB

### Profiler
...

[cpu flameGraph](get_cpu.html)

...

[alloc flameGraph](get_alloc.html)

...

[lock_flameGraph](get_lock.html)
